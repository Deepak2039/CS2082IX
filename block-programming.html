<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Block Programming - CS 2082</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/lesson.css">
    <link rel="stylesheet" href="css/mcq.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <header>
        <nav>
            <div class="logo">
                <i class="fas fa-laptop-code"></i>
                <a href="index.html" class="home-link">CS 2082</a>
            </div>
            <ul class="nav-links">
                <li><a href="index.html">Home</a></li>
            </ul>
        </nav>
    </header>

    <main class="lesson-container">
        <aside class="lesson-sidebar">
            <h3>Course Content</h3>
            <ul class="lesson-menu">
                <li class="active"><a href="block-programming.html">3.1 Introduction to Block Programming</a></li>
                <li><a href="scratch-basics.html">3.2 Scratch Basics</a></li>
                <li><a href="loops-conditionals.html">3.3 Loops & Conditionals</a></li>
                <li><a href="variables-blocks.html">3.4 Variables in Block Programming</a></li>
                <li><a href="block-projects.html">3.5 Creating Projects</a></li>
            </ul>
        </aside>

        <article class="lesson-content">
            <div class="navigation-buttons top-navigation">
                <div></div>
                <a href="scratch-basics.html" class="nav-button next">Next: 3.2 Scratch Basics <i class="fas fa-arrow-right"></i></a>
            </div>
            <h1>3. Block Programming</h1>
            
            <section id="introduction" class="lesson-section">
                <h2>3.1 Introduction to Block Programming</h2>
                <p>Welcome to the world of block programming! This module will introduce you to visual programming using blocks, making coding more accessible and fun for beginners.</p>
                
                <div class="learning-objectives">
                    <h3><i class="fas fa-bullseye"></i> Learning Objectives</h3>
                    <ul>
                        <li>Understand the basics of block-based programming</li>
                        <li>Learn about popular block programming environments</li>
                        <li>Understand the advantages of visual programming</li>
                    </ul>
                </div>
            </section>

            <section id="what-is-block-programming" class="lesson-section">
                <h3>3.1.1 What is Block Programming?</h3>
                <div class="definition-box">
                    <h4><i class="fas fa-lightbulb"></i> Definition</h4>
                    <p>Block programming is a visual programming language where users create programs by manipulating graphical blocks rather than writing text-based code. Each block represents a command, value, or control structure that can be snapped together to create programs.</p>
                </div>

                <div class="feature-item">
                    <h4><i class="fas fa-puzzle-piece"></i> Key Features</h4>
                    <ul class="application-list">
                        <li><strong>Drag-and-Drop Interface:</strong> No syntax errors as blocks only fit together in ways that make sense</li>
                        <li><strong>Visual Feedback:</strong> Immediate visualization of program flow</li>
                        <li><strong>Beginner-Friendly:</strong> Reduces the learning curve for programming concepts</li>
                        <li><strong>Conceptual Understanding:</strong> Focuses on logic rather than syntax</li>
                    </ul>
                </div>
            </section>

            <section id="block-environments" class="lesson-section">
                <h3>3.1.2 Popular Block Programming Environments</h3>
                
                <div class="info-table">
                    <table>
                        <tr>
                            <th>Environment</th>
                            <th>Best For</th>
                            <th>Features</th>
                        </tr>
                        <tr>
                            <td><strong>Scratch</strong></td>
                            <td>Beginners, Education</td>
                            <td>Game development, animations, stories</td>
                        </tr>
                        <tr>
                            <td><strong>Blockly</strong></td>
                            <td>Web Development</td>
                            <td>Customizable, outputs to JavaScript/Python</td>
                        </tr>
                        <tr>
                            <td><strong>App Inventor</strong></td>
                            <td>Mobile Apps</td>
                            <td>Create Android apps without coding</td>
                        </tr>
                        <tr>
                            <td><strong>MakeCode</strong></td>
                            <td>Hardware Programming</td>
                            <td>Micro:bit, Circuit Playground</td>
                        </tr>
                    </table>
                </div>
            </section>

            <section id="benefits" class="lesson-section">
                <h3>3.1.3 Benefits of Block Programming</h3>
                
                <div class="feature-item">
                    <h4><i class="fas fa-graduation-cap"></i> Educational Advantages</h4>
                    <ul class="application-list">
                        <li><strong>Reduced Cognitive Load:</strong> Focus on logic rather than syntax</li>
                        <li><strong>Immediate Feedback:</strong> See results of code immediately</li>
                        <li><strong>Lower Entry Barrier:</strong> Accessible to younger students and beginners</li>
                        <li><strong>Concept Reinforcement:</strong> Visual representation of programming concepts</li>
                    </ul>
                </div>
                
                <div class="feature-item">
                    <h4><i class="fas fa-cogs"></i> Practical Applications</h4>
                    <ul class="application-list">
                        <li><strong>Game Development:</strong> Create interactive games without complex coding</li>
                        <li><strong>Storytelling:</strong> Combine programming with digital storytelling</li>
                        <li><strong>Prototyping:</strong> Quickly prototype app ideas</li>
                        <li><strong>Education:</strong> Teach computational thinking concepts</li>
                    </ul>
                </div>
                
                <div class="real-world-example">
                    <h4><i class="fas fa-mobile-alt"></i> Real World Example</h4>
                    <p>Many successful games and applications started as block programming prototypes. For example, the popular game "Flappy Bird" has been recreated in Scratch by thousands of learners, helping them understand game mechanics and programming logic in a fun, engaging way.</p>
                </div>
            </section>

            <div class="navigation-buttons"> 
                <div></div>
                <a href="scratch-basics.html" class="nav-button next">Next: 3.2 Scratch Basics <i class="fas fa-arrow-right"></i></a>
            </div>

            <!-- Quiz Section -->
            <section id="quiz-section" class="lesson-section">
                <h2><i class="fas fa-question-circle"></i> Knowledge Check</h2>
                <p>Test your understanding of block programming with these multiple-choice questions.</p>
                
                <div id="quiz-container">
                    <div id="question-container">
                        <div id="question">Question</div>
                        <div id="answer-buttons" class="btn-grid">
                            <!-- Answer buttons will be added here by JavaScript -->
                        </div>
                    </div>
                    <div id="explanation" class="explanation"></div>
                    <div class="controls">
                        <button id="prev-btn" class="btn">Previous</button>
                        <button id="next-btn" class="btn">Next</button>
                        <button id="submit-btn" class="btn" style="display: none;">Submit Quiz</button>
                    </div>
                    <div class="quiz-status">
                        <div id="score-display" style="margin-bottom: 1rem; font-weight: bold; color: #1976d2;">
                            Score: <span id="current-score">0</span> / <span id="max-score">0</span>
                        </div>
                        <div id="progress">Question 1 of 10</div>
                    </div>
                    <div id="results" style="display: none; margin-top: 2rem; padding: 1.5rem; background-color: #e8f5e9; border-radius: 8px; text-align: center;">
                        <h3>Quiz Completed!</h3>
                        <p>Your score: <span id="score">0</span> out of <span id="total-questions">0</span></p>
                        <button id="restart-btn" class="btn" style="margin-top: 1rem; background-color: #2196f3; color: white; border: none; padding: 0.75rem 1.5rem; border-radius: 6px; cursor: pointer;">Restart Quiz</button>
                    </div>
                </div>
            </section>
        </article>
    </main>

    <script src="js/block-programming-questions.js"></script>
    <script>
        // Quiz variables
        let currentQuestionIndex = 0;
        let userAnswers = [];
        let score = 0;

        // DOM elements
        const questionElement = document.getElementById('question');
        const answerButtonsElement = document.getElementById('answer-buttons');
        const nextButton = document.getElementById('next-btn');
        const prevButton = document.getElementById('prev-btn');
        const submitButton = document.getElementById('submit-btn');
        const explanationElement = document.getElementById('explanation');
        const progressElement = document.getElementById('progress');

        // Update the score display
        function updateScoreDisplay() {
            const currentScoreElement = document.getElementById('current-score');
            const maxScoreElement = document.getElementById('max-score');
            if (currentScoreElement && maxScoreElement) {
                currentScoreElement.textContent = score;
                maxScoreElement.textContent = blockProgrammingQuestions.length;
            }
        }

        // Initialize the quiz
        function startQuiz() {
            console.log('Starting quiz...');
            console.log('Questions loaded:', blockProgrammingQuestions.length);
            
            currentQuestionIndex = 0;
            score = 0;
            userAnswers = Array(blockProgrammingQuestions.length).fill(null);
            document.getElementById('results').style.display = 'none';
            document.getElementById('quiz-container').style.display = 'block';
            updateScoreDisplay();
            showQuestion();
            updateProgress();
        }

        // Display the current question
        function showQuestion() {
            console.log('showQuestion called with index:', currentQuestionIndex);
            resetState();
            const currentQuestion = blockProgrammingQuestions[currentQuestionIndex];
            console.log('Current question data:', currentQuestion);
            if (!currentQuestion) {
                console.error('No question found at index:', currentQuestionIndex);
                return;
            }
            questionElement.textContent = `${currentQuestionIndex + 1}. ${currentQuestion.question}`;
            
            // Create answer buttons
            currentQuestion.options.forEach((option, index) => {
                const button = document.createElement('button');
                button.textContent = option;
                button.classList.add('btn');
                button.dataset.index = index;
                button.addEventListener('click', selectAnswer);
                answerButtonsElement.appendChild(button);
                
                // Highlight selected answer if exists
                if (userAnswers[currentQuestionIndex] === index) {
                    button.classList.add('selected');
                    showExplanation(button);
                }
            });

            updateNavigationButtons();
        }

        // Reset the quiz state for a new question
        function resetState() {
            // Clear previous answers
            while (answerButtonsElement.firstChild) {
                answerButtonsElement.removeChild(answerButtonsElement.firstChild);
            }
            
            // Reset UI elements
            explanationElement.textContent = '';
            explanationElement.className = 'explanation';
        }

        // Handle answer selection
        function selectAnswer(e) {
            const selectedButton = e.target;
            const selectedIndex = parseInt(selectedButton.dataset.index);
            
            // Save user's answer
            userAnswers[currentQuestionIndex] = selectedIndex;
            
            // Check if answer is correct
            const isCorrect = selectedIndex === blockProgrammingQuestions[currentQuestionIndex].answer;
            
            // Update score if not already answered
            if (userAnswers[currentQuestionIndex] === selectedIndex && isCorrect) {
                score++;
                updateScoreDisplay();
            }
            
            // Highlight selected answer
            const buttons = answerButtonsElement.querySelectorAll('.btn');
            buttons.forEach(button => button.classList.remove('selected', 'correct', 'incorrect'));
            selectedButton.classList.add('selected');
            
            // Show explanation
            showExplanation(selectedButton);
            
            // Update navigation buttons
            updateNavigationButtons();
        }

        // Show explanation for the selected answer
        function showExplanation(selectedButton) {
            const currentQuestion = blockProgrammingQuestions[currentQuestionIndex];
            const selectedIndex = parseInt(selectedButton.dataset.index);
            
            // Show explanation
            explanationElement.textContent = currentQuestion.explanation;
            explanationElement.style.display = 'block';
            
            // Style based on correct/incorrect answer
            if (selectedIndex === currentQuestion.answer) {
                explanationElement.classList.add('correct');
                selectedButton.classList.add('correct');
            } else {
                explanationElement.classList.add('incorrect');
                selectedButton.classList.add('incorrect');
                // Also show the correct answer
                const buttons = answerButtonsElement.querySelectorAll('.btn');
                buttons[currentQuestion.answer].classList.add('correct');
            }
        }

        // Update navigation buttons state
        function updateNavigationButtons() {
            // Previous button
            prevButton.style.display = currentQuestionIndex === 0 ? 'none' : 'inline-block';
            
            // Next/Submit button
            if (currentQuestionIndex === blockProgrammingQuestions.length - 1) {
                nextButton.style.display = 'none';
                submitButton.style.display = 'inline-block';
                submitButton.disabled = userAnswers[currentQuestionIndex] === null;
            } else {
                nextButton.style.display = 'inline-block';
                submitButton.style.display = 'none';
                nextButton.disabled = userAnswers[currentQuestionIndex] === null;
            }
        }

        // Update progress indicator
        function updateProgress() {
            progressElement.textContent = `Question ${currentQuestionIndex + 1} of ${blockProgrammingQuestions.length}`;
        }

        // Calculate and show final score
        function showResults() {
            // Calculate final score
            const finalScore = userAnswers.reduce((total, answer, index) => {
                return answer === blockProgrammingQuestions[index].answer ? total + 1 : total;
            }, 0);
            
            // Update the final score display
            document.getElementById('score').textContent = finalScore;
            document.getElementById('total-questions').textContent = blockProgrammingQuestions.length;
            
            // Show results and hide quiz
            document.getElementById('quiz-container').style.display = 'none';
            document.getElementById('results').style.display = 'block';
        }

        // Event listeners
        nextButton.addEventListener('click', () => {
            if (currentQuestionIndex < blockProgrammingQuestions.length - 1) {
                currentQuestionIndex++;
                showQuestion();
                updateProgress();
            }
        });

        prevButton.addEventListener('click', () => {
            if (currentQuestionIndex > 0) {
                currentQuestionIndex--;
                showQuestion();
                updateProgress();
            }
        });

        submitButton.addEventListener('click', showResults);
        
        document.getElementById('restart-btn').addEventListener('click', startQuiz);

    </script>

    <footer>
        <div class="footer-content">
            <div class="footer-section">
                <h3>About This Course</h3>
                <p>This course introduces block programming concepts using visual programming environments like Scratch.</p>
            </div>
            <div class="footer-section">
                <h3>Quick Links</h3>
                <ul>
                    <li><a href="index.html">Home</a></li>
                    <li><a href="quiz.html">Take Quiz</a></li>
                </ul>
            </div>
        </div>
        <div class="footer-bottom">
            <p>&copy; 2024 CS 2082 - Updated Computer Science Curriculum</p>
        </div>
    </footer>

    <!-- Chapter-specific JavaScript is already included above -->
    <script src="js/chapters/block-programming.js"></script>
    <script>
        // Start the quiz when the page loads
        document.addEventListener('DOMContentLoaded', function() {
            console.log('DOM fully loaded, starting quiz...');
            startQuiz();
            
            // Add scroll event for progress tracking
            window.addEventListener('scroll', function() {
                const sections = document.querySelectorAll('.lesson-section');
                const totalSections = sections.length;
                let viewedSections = 0;
                
                sections.forEach(section => {
                    const rect = section.getBoundingClientRect();
                    if (rect.top < window.innerHeight && rect.bottom > 0) {
                        section.classList.add('viewed');
                    }
                });
                
                viewedSections = document.querySelectorAll('.lesson-section.viewed').length;
                const progress = Math.round((viewedSections / totalSections) * 100);
                
                const progressBar = document.querySelector('.progress-bar');
                if (progressBar) {
                    progressBar.style.width = progress + '%';
                    progressBar.setAttribute('aria-valuenow', progress);
                }
            });
        });
    </script>
</body>
</html>
